<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Skilled Worker Salary Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 2rem; }
    .section { margin-bottom: 2rem; }
    label { display: block; margin: 0.5rem 0 0.25rem; }
    select, input { width: 100%; padding: 0.5rem; }
    .result { margin-top: 1rem; font-weight: bold; }
  </style>
</head>
<body>
  <h1>UK Skilled Worker Salary Calculator</h1>

  <div class="section">
    <label for="socCode">SOC Code:</label>
    <select id="socCode"></select>

    <label for="annualSalary">Proposed Annual Salary (£):</label>
    <input type="number" id="annualSalary" />

    <label for="weeklyHours">Weekly Working Hours:</label>
    <input type="number" id="weeklyHours" value="37.5" />

    <label>Discount Scenario (select one):</label>
    <select id="scenario">
      <option value="none">None</option>
      <option value="new_entrant">New Entrant</option>
      <option value="phd_stem">PhD (STEM)</option>
      <option value="phd_other">PhD (Non-STEM)</option>
      <option value="postdoc">Postdoctoral Researcher</option>
      <option value="isl">Immigration Salary List (ISL)</option>
    </select>

    <button onclick="calculateEligibility()">Check Eligibility</button>
    <div class="result" id="result"></div>
  </div>

  <script>
    const generalThreshold = 41700;
    const hourlyMinimum = 17.13;
    const floor33k = 33400;
    const floor37k = 37500;

    const socs = {
      "2136": { name: "Programmer", rate: 45000 },
      "2111": { name: "Biological Scientist", rate: 40000 },
      "1233": { name: "Early Education Proprietor (Health/Education exception)", rate: 25000, exception: true }
      // Extend with full SOC list...
    };

    const socDropdown = document.getElementById('socCode');
    for (const [code, data] of Object.entries(socs)) {
      const option = document.createElement('option');
      option.value = code;
      option.textContent = `${code} - ${data.name}`;
      socDropdown.appendChild(option);
    }

    function calculateEligibility() {
      const code = document.getElementById('socCode').value;
      const salary = parseFloat(document.getElementById('annualSalary').value);
      const hours = Math.min(parseFloat(document.getElementById('weeklyHours').value), 48);
      const scenario = document.getElementById('scenario').value;
      const soc = socs[code];

      const goingRate = soc.rate;
      const isException = soc.exception || false;
      const hourlyRate = salary / (hours * 52);

      let requiredSalary = generalThreshold;

      if (scenario === 'new_entrant' || scenario === 'postdoc') {
        requiredSalary = Math.max(goingRate * 0.7, floor33k);
      } else if (scenario === 'phd_stem') {
        requiredSalary = Math.max(goingRate * 0.8, floor33k);
      } else if (scenario === 'phd_other') {
        requiredSalary = Math.max(goingRate * 0.9, floor37k);
      } else if (scenario === 'isl') {
        requiredSalary = Math.max(goingRate, floor33k); // ISL doesn't reduce going rate
      } else {
        requiredSalary = Math.max(generalThreshold, goingRate);
      }

      const requiredHourly = requiredSalary / (hours * 52);
      const effectiveHourly = isException ? salary / (hours * 52) : Math.max(requiredHourly, hourlyMinimum);

      const isEligible = !isException
        ? (salary >= requiredSalary && hourlyRate >= hourlyMinimum)
        : (salary >= goingRate);

      document.getElementById('result').textContent = isEligible
        ? `✅ Eligible. Salary meets ${requiredSalary.toFixed(2)} and £${effectiveHourly.toFixed(2)}/hr.`
        : `❌ Not eligible. Must earn at least £${requiredSalary.toFixed(2)} and £${effectiveHourly.toFixed(2)}/hr.`;
    }
  </script>
</body>
</html>

